"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const _=require("buffer"),u=require("http"),n=require("./index-AQefyu2b.js");function I(e){return new Promise((d,a)=>{var s;const t=u.request({method:"GET",...e,hostname:(s=e.hostname)==null?void 0:s.replace(/^\[(.+)\]$/,"$1")});t.on("error",r=>{a(Object.assign(new n.ProviderError("Unable to connect to instance metadata service"),r)),t.destroy()}),t.on("timeout",()=>{a(new n.ProviderError("TimeoutError from instance metadata service")),t.destroy()}),t.on("response",r=>{const{statusCode:i=400}=r;(i<200||300<=i)&&(a(Object.assign(new n.ProviderError("Error response received from instance metadata service"),{statusCode:i})),t.destroy());const c=[];r.on("data",E=>{c.push(E)}),r.on("end",()=>{d(_.Buffer.concat(c)),t.destroy()})}),t.end()})}exports.Endpoint=void 0;(function(e){e.IPv4="http://169.254.169.254",e.IPv6="http://[fd00:ec2::254]"})(exports.Endpoint||(exports.Endpoint={}));const N="AWS_EC2_METADATA_SERVICE_ENDPOINT",v="ec2_metadata_service_endpoint",P={environmentVariableSelector:e=>e[N],configFileSelector:e=>e[v],default:void 0};var o;(function(e){e.IPv4="IPv4",e.IPv6="IPv6"})(o||(o={}));const O="AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE",p="ec2_metadata_service_endpoint_mode",f={environmentVariableSelector:e=>e[O],configFileSelector:e=>e[p],default:o.IPv4},l=async()=>n.parseUrl(await m()||await T()),m=async()=>n.loadConfig(P)(),T=async()=>{const e=await n.loadConfig(f)();switch(e){case o.IPv4:return exports.Endpoint.IPv4;case o.IPv6:return exports.Endpoint.IPv6;default:throw new Error(`Unsupported endpoint mode: ${e}. Select from ${Object.values(o)}`)}};exports.getInstanceMetadataEndpoint=l;exports.httpRequest=I;
//# sourceMappingURL=index-Dc2Bfoce.js.map
